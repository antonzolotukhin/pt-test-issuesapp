## Тестовое задание

### Подготовка

  В процессе изучения документации на https://developer.github.com/v3 был сделан вывод о том, что единственным доступным способом просмотра issues по всем репозиториям пользователя является получение списка репозиториев пользователя запросом `GET users/:user/repos` и просмотр issues в каждом репозитории запросом `GET /repos/:user/:repo/issues`.
  
  Результат запросов выдается в формате JSON.
  
### Разработка утилиты
  
  Для запросов к серверу и получения ответов использована бибилиотека **requests**, как указано в условиях задания.
  
  Для парсинга ответов применена стандартная библиотека **json**.
  
  Запросы к серверу вынесены в отдельную функцию, которая принимает в качестве аргумента uri запроса и в случае успешного выполнения (HTTP статус 200 OK) возвращает словарь или список содержащий распарсенный ответ.
  
  В случае неудачного запроса (uri не найден, нет доступа) генерируется исключение, содержащее ответ сервера.
  
  Запросы списка репозиториев и issues вынесены в отдельные функции, возвращающие генератор для того, чтобы не итерировать списки дважды - при разборе ответа и при выводе на экран.
  
  Помимо просмотра репозиториев devopshq утилита позволяет просмотреть issues произвольного аккаунта репозитория.
  
  В этом случае необходимо задать просмотриваемый аккаунт и/или репозиторий с помощью необязательных аргументов командной строки `--user` и `--repo`.
  
  Также реализована возможность задать учётные данные от имени которых будут производиться запросы. 
  
  Для работы с аргументами командной строки используется стандартная библиотека argparse.
  
### Разработка тестов
  
  Тестирования без запросов к серверу реализовано посредством mock'а на базе библиотеки **HTTPretty**.
  За основу взят mock из проекта https://github.com/devopshq/tfs.
  
  Реализованы следующие тесты:
  Функция `GitHubAPIRequest()` проверяется на:
- корректность возвращаемых данных (можно получить правильные значения элементов по их позиции, наименованию);
- генерацию исключений при статусе ответа отличном от 200;
  Функция `GetReposByUser()`, `GetIssuesByUserRepo()` проверяется на.
- корректность возвращаемых данных (можно получить правильные значения элементов по их позиции, наименованию);
- соответствие количества элементов входным данным.
  Функция `GithubCredsType()` проверяется на:
- генерацию исключения при передаче аргумента отличного от пустой строки, не соответсвующего заданному формату;
- корректную отработку валидных значений.

  Скорее всего, было бы более правильно создать stub'ы функции `GitHubAPIRequest()` для отдельного тестирования функций `GetReposByUser()`, `GetIssuesByUserRepo()`. Чтобы при ошибке в `GitHubAPIRequest()` не оказывали влияние на прохождение тестов указанными функциями.
  
### Сборка Docker-образа

  Производится самым тривиальным образом  - `docker build` с использованием Dockerfile.

### travis-ci

  В соответствии с заданием, travis следит за ветками develop и master. При пуше в ветку, устанавливаются зависимости для тестовой среды. В случае успешного выполнения тестов, собирается Docker-образ и выкладывается на dockerhub.
  
### Результат

Приложение можно запустить командой:

```$ docker run ptmn/devopshqissues:latest```

```
artifactory:

#138 AQL issue
#135 downloading text files with utf-8 encoding
...
zabbix-youtrack-action:

#3 Create install script
#2 Create good docs
#1 Refactor code

zabbixtools:

```

Аргументы передаются в приложение, можно вывести справку:

```$ docker run ptmn/devopshqissues:latest -h```

```
usage: issuesapp.py [-h] [-u USER] [-r REPO] [-c CREDS]

optional arguments:
  -h, --help            show this help message and exit
  -u USER, --user USER  You can define github account instead of "devopshq".
  -r REPO, --repo REPO  Also you can specify repository.
  -c CREDS, --creds CREDS
                        Access credentials in format "login:token".
```

